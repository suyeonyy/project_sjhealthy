<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>추천 게시판</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
<h1>추천 게시판</h1>

    <table border="1">
        <thead>
        <tr>
            <th>글 번호</th>
            <th>제목</th>
            <th>작성자</th>
            <th>작성일</th>
            <th>조회수</th>
        </tr>
        </thead>

        <tbody>
        <tr th:each="board : ${list}">
            <td th:text="${board.recId}"></td>
            <td th:text="${board.recStore}"></td>
            <td th:text="${board.recMenu}"></td>
            <td th:text="${board.memberId}"></td>
            <td th:text="${board.createDate}"></td>
            <td th:text="${board.recY}"></td>
            <td th:text="${board.recN}"></td>
        </tr>
        </tbody>
    </table>
    <input type="hidden" th:value="${loginId}" id="loginId"> 
    <!-- th:text는 html 요소의 텍스트 내용을 설정. 따라서 value로 읽으려면 th:value로 해야 한다 -->
    <a href="/sjhealthy"><button>메인</button></a>
    <a href="/sjhealthy/recommend/write" id="writeButton"><button>추천글 작성</button></a>

<script>
    document.addEventListener("DOMContentLoaded", ()=>{
        const writeButton = document.getElementById("writeButton");
        const loginId = document.getElementById("loginId").value;
        console.log('loginId = ' + loginId);

        if (writeButton){
            writeButton.addEventListener("click", async (e)=> {

                if (!loginId){ 
                    // 값이 없을 때는 null 이 아니라 "" 빈 문자열이 보내진다. 
                    // 따라서 서버에서 보낸 값을 text로 설정하고 value를 읽어와도 해당 속성 값이 없으니 null이 아니라 ""를 읽어오게 됨
                    // 서버에서 null을 보내도 렌더링 되는 과정에서 ""가 되기 때문에 
                    // 자바스크립트 조건문에서 null과 비교하는 건 의미가 없다.
                    // !로 하면 null일 때랑 빈 문자열일 때 둘 다 false로 판단하니까 이렇게 하면 됨
                    e.preventDefault(); // defaultPrevented는 이벤트가 취소됐는지 확인하는 메서드로 다른 거다. 잘못 쓰지 않도록 하자
                    alert('글은 회원만 작성할 수 있습니다.');
                    return false;
                }
            });
        }
    });
</script>
</body>
</html>
