<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>LoginForm</title>
</head>
<body>
<div th:replace="~{fragment/headerNoSession :: main-head}"></div>
    <h1>아이디 찾기</h1>

<form action="../member/find-id" method="POST" th:if="${memberDTO == null && dto == null}" id="findIdForm">
    이름: <input type="text" name="memberName" id="memberName" placeholder="이름을 입력해 주세요."><br>
    생년월일: <input type="text" name="memberBirth" id="memberBirth" placeholder="8자로 입력해 주세요."><br>
    <input type="submit" name="findId" value="아이디 찾기" id="findId">
</form>

<p th:if="${memberDTO != null}">
    찾으시는 아이디는 <input type="text" name="memberName" th:value="${memberDTO.memberId}" readonly>입니다.<br>
    <a href="../member/login"><button>로그인</button></a>
    <a href="../member/find-password"><button>비밀번호 찾기</button></a>
</p>
<p th:if="${dto != null}">
    아이디가 존재하지 않습니다.<br>
    <a href="../member/login"><button>로그인</button></a>
    <a href="../member/find-id"><button>아이디 찾기</button></a>
</p>

<script>
    document.addEventListener("DOMContentLoaded", () => {
        const findId = document.getElementById("findId");
        const findIdForm = document.getElementById("findIdForm");

        findId.addEventListener("click", (e) => {
            e.preventDefault();

            const name = document.getElementById("memberName").value;
            const birth = document.getElementById("memberBirth").value;
            const check = /^\d{8}$/; // 8자 유효성 검사

            if (!name){
                alert("이름을 입력해 주세요.");
            } else if (!birth){
                alert("생년월일을 입력해 주세요.");
            } else if (!check.test(birth)){ 
                alert("생년월일은 8자리 숫자로 입력해주세요.");
            } else {
                findIdForm.submit();
                // 되나 확인하기
            }
        });
    });
</script>
<div th:replace="~{fragment/footer :: main-foot}"></div>
</body>
</html>
